#  This file is part of systemd-swap.
#
# Configuration for systemd-swap daemon.
# See swap.conf(5) for details.

################################################################################
# Swap Mode - How swap is configured
#
# auto            - Auto-detect: btrfs → zswap+swapfc, non-btrfs → zram only
# zswap+swapfc    - Force zswap with swap files (requires btrfs)
# zram            - Force zram only
# manual          - Use explicit settings below (legacy mode)
################################################################################

swap_mode=auto

################################################################################
# Zswap - Compressed RAM cache for swap pages
#
# zswap compresses pages before writing to swap, reducing I/O.
# Automatically enabled in zswap+swapfc mode. Use zswap_enabled=0 to disable.
# Requires a backing swap device (swap file or partition).
################################################################################

zswap_compressor=zstd       # lzo lz4 zstd lzo-rle lz4hc
zswap_max_pool_percent=45   # Max % of RAM for compressed pool
zswap_zpool=zsmalloc        # Memory allocator

################################################################################
# Zram - Compressed RAM disk
# Only used when swap_mode=zram or manual with zram_enabled=1
#
# zram creates a compressed block device in RAM for swap
# More efficient than zswap for systems without backing swap
################################################################################

zram_size=$RAM_SIZE         # Size (default: equal to RAM)
zram_alg=zstd               # Compression: lzo lz4 zstd lzo-rle lz4hc
zram_prio=32767             # Swap priority

################################################################################
# SwapFC - Dynamic swap file management (btrfs only)
# Only used when swap_mode=zswap+swapfc or manual with swapfc_enabled=1
#
# Creates swap files on-demand as memory pressure increases
################################################################################

swapfc_chunk_size=512M           # Size of each swap file
swapfc_max_count=32              # Maximum number of swap files
swapfc_min_count=1               # Minimum (1 for zswap backing)
swapfc_free_ram_perc=35          # Create swap when free RAM < this %
swapfc_free_swap_perc=25         # Create more swap when free swap < this %
swapfc_remove_free_swap_perc=55  # Remove swap when free swap > this %
swapfc_priority=50               # Swap priority (decreases per file)
swapfc_path=/swapfc/swapfile     # Path for swap files (must be btrfs)
swapfc_frequency=1               # Check interval in seconds

################################################################################
# Enable/disable settings
# zswap_enabled: Set to 0 to disable zswap (default: 1, enabled when not using zram)
# zram_enabled: Only used in manual mode
# swapfc_enabled: Only used in manual mode
################################################################################

zswap_enabled=1
zram_enabled=0
swapfc_enabled=0
swapd_auto_swapon=0
